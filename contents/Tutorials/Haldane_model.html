
<!DOCTYPE html>


<html lang="en" data-content_root="../../" data-theme="auto">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Haldane model &#8212; HyperCells &amp; HyperBloch</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "auto";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "auto";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=d9e52e08" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../_static/documentation_options.js?v=01f34227"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/Tutorials/Haldane_model';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Hatano-Nelson model" href="HatanoNelson_model.html" />
    <link rel="prev" title="Flat-bands" href="Flat-bands.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="auto">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/html_logo_HyperSupercells2_light.png" class="logo__image only-light" alt="HyperCells & HyperBloch - Home"/>
    <img src="../../_static/html_logo_HyperSupercells2_dark.png" class="logo__image only-dark pst-js-only" alt="HyperCells & HyperBloch - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../About/about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Installation/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../GettingStarted/getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Documentation/documentation.html">
    Documentation
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../Contribute/contribute.html">
    How to contribute
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../Cite/cite.html">
    How to cite
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../LicenseCopyright/licenseCopyright.html">
    License and copyright
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/HyperCells" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../About/about.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Installation/installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../GettingStarted/getting_started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="tutorials.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Documentation/documentation.html">
    Documentation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Contribute/contribute.html">
    How to contribute
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Cite/cite.html">
    How to cite
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../LicenseCopyright/licenseCopyright.html">
    License and copyright
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/HyperCells" title="Github" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Github</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Supercells.html">Supercells</a></li>
<li class="toctree-l1"><a class="reference internal" href="Coherent_SC_sequences.html">Coherent sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="Flat-bands.html">Flat-bands</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Haldane model</a></li>
<li class="toctree-l1"><a class="reference internal" href="HatanoNelson_model.html">Hatano-Nelson model</a></li>
<li class="toctree-l1"><a class="reference internal" href="HigherOrder_topology.html">Higher-order topology</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="tutorials.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Haldane model</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="haldane-model">
<h1>Haldane model<a class="headerlink" href="#haldane-model" title="Link to this heading">#</a></h1>
<details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-success sd-bg-text-success">
<span class="sd-summary-icon"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-light-bulb" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg></span><span class="sd-summary-text">Learning goals</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text">Construction of:</p>
<ul class="simple">
<li><p class="sd-card-text">next-nearest-neighbor model graphs,</p></li>
<li><p class="sd-card-text">Abelian Bloch Hamiltonians with orientated couplings,</p></li>
<li><p class="sd-card-text">point-group matrices and symmetry analysis.</p></li>
</ul>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-info sd-bg-text-info">
<span class="sd-summary-icon"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-gear" viewBox="0 0 16 16" aria-hidden="true"><path d="M8 0a8.2 8.2 0 0 1 .701.031C9.444.095 9.99.645 10.16 1.29l.288 1.107c.018.066.079.158.212.224.231.114.454.243.668.386.123.082.233.09.299.071l1.103-.303c.644-.176 1.392.021 1.82.63.27.385.506.792.704 1.218.315.675.111 1.422-.364 1.891l-.814.806c-.049.048-.098.147-.088.294.016.257.016.515 0 .772-.01.147.038.246.088.294l.814.806c.475.469.679 1.216.364 1.891a7.977 7.977 0 0 1-.704 1.217c-.428.61-1.176.807-1.82.63l-1.102-.302c-.067-.019-.177-.011-.3.071a5.909 5.909 0 0 1-.668.386c-.133.066-.194.158-.211.224l-.29 1.106c-.168.646-.715 1.196-1.458 1.26a8.006 8.006 0 0 1-1.402 0c-.743-.064-1.289-.614-1.458-1.26l-.289-1.106c-.018-.066-.079-.158-.212-.224a5.738 5.738 0 0 1-.668-.386c-.123-.082-.233-.09-.299-.071l-1.103.303c-.644.176-1.392-.021-1.82-.63a8.12 8.12 0 0 1-.704-1.218c-.315-.675-.111-1.422.363-1.891l.815-.806c.05-.048.098-.147.088-.294a6.214 6.214 0 0 1 0-.772c.01-.147-.038-.246-.088-.294l-.815-.806C.635 6.045.431 5.298.746 4.623a7.92 7.92 0 0 1 .704-1.217c.428-.61 1.176-.807 1.82-.63l1.102.302c.067.019.177.011.3-.071.214-.143.437-.272.668-.386.133-.066.194-.158.211-.224l.29-1.106C6.009.645 6.556.095 7.299.03 7.53.01 7.764 0 8 0Zm-.571 1.525c-.036.003-.108.036-.137.146l-.289 1.105c-.147.561-.549.967-.998 1.189-.173.086-.34.183-.5.29-.417.278-.97.423-1.529.27l-1.103-.303c-.109-.03-.175.016-.195.045-.22.312-.412.644-.573.99-.014.031-.021.11.059.19l.815.806c.411.406.562.957.53 1.456a4.709 4.709 0 0 0 0 .582c.032.499-.119 1.05-.53 1.456l-.815.806c-.081.08-.073.159-.059.19.162.346.353.677.573.989.02.03.085.076.195.046l1.102-.303c.56-.153 1.113-.008 1.53.27.161.107.328.204.501.29.447.222.85.629.997 1.189l.289 1.105c.029.109.101.143.137.146a6.6 6.6 0 0 0 1.142 0c.036-.003.108-.036.137-.146l.289-1.105c.147-.561.549-.967.998-1.189.173-.086.34-.183.5-.29.417-.278.97-.423 1.529-.27l1.103.303c.109.029.175-.016.195-.045.22-.313.411-.644.573-.99.014-.031.021-.11-.059-.19l-.815-.806c-.411-.406-.562-.957-.53-1.456a4.709 4.709 0 0 0 0-.582c-.032-.499.119-1.05.53-1.456l.815-.806c.081-.08.073-.159.059-.19a6.464 6.464 0 0 0-.573-.989c-.02-.03-.085-.076-.195-.046l-1.102.303c-.56.153-1.113.008-1.53-.27a4.44 4.44 0 0 0-.501-.29c-.447-.222-.85-.629-.997-1.189l-.289-1.105c-.029-.11-.101-.143-.137-.146a6.6 6.6 0 0 0-1.142 0ZM11 8a3 3 0 1 1-6 0 3 3 0 0 1 6 0ZM9.5 8a1.5 1.5 0 1 0-3.001.001A1.5 1.5 0 0 0 9.5 8Z"></path></svg></span><span class="sd-summary-text">Featured functions</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>HyperCells:</strong></p>
<code class="code-gap">
AddOrientedNNNEdgesToTessellationModelGraph, EvaluatePGMatrix, Export, FpGroup, LongestSequence, PGMatrices, PGMatricesOfGenerators, ProperTriangleGroup, TessellationModelGraph, TGCellGraph, TGCellSymmetric, TGQuotient,  TGQuotientSequencesStructure, TGSuperCellModelGraph, TriangleGroup
</code>
<br></br>
<p class="sd-card-text"><strong>HyperBloch:</strong></p>
<code class="code-Mathematica">
AbelianBlochHamiltonian, GetCellGraphFace, GetEdge, GetSchwarzTriangle, GetVertex, ImportCellGraphString, ImportModelGraphString, ImportPGMatricesString, ImportSupercellModelGraphString, ShowCellBoundary, ShowCellGraphFlattened, ShowCellSchwarzTriangles, ShowTriangles, VisualizeModelGraph
</code>
</div>
</details><details class="sd-sphinx-override sd-dropdown sd-card sd-mb-3">
<summary class="sd-summary-title sd-card-header sd-bg-warning sd-bg-text-warning">
<span class="sd-summary-icon"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-tools" viewBox="0 0 16 16" aria-hidden="true"><path d="M5.433 2.304A4.492 4.492 0 0 0 3.5 6c0 1.598.832 3.002 2.09 3.802.518.328.929.923.902 1.64v.008l-.164 3.337a.75.75 0 1 1-1.498-.073l.163-3.33c.002-.085-.05-.216-.207-.316A5.996 5.996 0 0 1 2 6a5.993 5.993 0 0 1 2.567-4.92 1.482 1.482 0 0 1 1.673-.04c.462.296.76.827.76 1.423v2.82c0 .082.041.16.11.206l.75.51a.25.25 0 0 0 .28 0l.75-.51A.249.249 0 0 0 9 5.282V2.463c0-.596.298-1.127.76-1.423a1.482 1.482 0 0 1 1.673.04A5.993 5.993 0 0 1 14 6a5.996 5.996 0 0 1-2.786 5.068c-.157.1-.209.23-.207.315l.163 3.33a.752.752 0 0 1-1.094.714.75.75 0 0 1-.404-.64l-.164-3.345c-.027-.717.384-1.312.902-1.64A4.495 4.495 0 0 0 12.5 6a4.492 4.492 0 0 0-1.933-3.696c-.024.017-.067.067-.067.16v2.818a1.75 1.75 0 0 1-.767 1.448l-.75.51a1.75 1.75 0 0 1-1.966 0l-.75-.51A1.75 1.75 0 0 1 5.5 5.282V2.463c0-.092-.043-.142-.067-.159Z"></path></svg></span><span class="sd-summary-text">Needed functions</span><span class="sd-summary-state-marker sd-summary-chevron-right"><svg version="1.1" width="1.5em" height="1.5em" class="sd-octicon sd-octicon-chevron-right" viewBox="0 0 24 24" aria-hidden="true"><path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"></path></svg></span></summary><div class="sd-summary-content sd-card-body docutils">
<p class="sd-card-text"><strong>Mathematica:</strong></p>
<p class="sd-card-text">In previous tutorials, such as <a class="reference internal" href="../GettingStarted/getSetGo_HyperBloch.html"><span class="std std-doc">Getting started with the HyperBloch package</span></a> and HyperBloch <a class="reference internal" href="Supercells.html"><span class="std std-doc">Supercells</span></a> tutorial etc., we have calculated the density of states of various nearest-neighbor tight-binding models via exact diagonalization and random samples. We predefine a function in order to calculate the eigenvalues for the Abelian Bloch Hamiltonians that we will construct. We  take advantage of the independence of different momentum sectors and parallelize the computation, where we partition the set of <code class="code-Mathematica">Npts</code> into <code class="code-Mathematica">Nruns</code> subsets:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">ComputeEigenvalues</span><span class="p">[</span><span class="nv">cfH_</span><span class="p">,</span><span class="w"> </span><span class="nv">Npts_</span><span class="p">,</span><span class="w"> </span><span class="nv">Nruns_</span><span class="p">,</span><span class="w"> </span><span class="nv">genus_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span>
<span class="w"> </span><span class="n">Flatten</span><span class="o">@</span><span class="n">ParallelTable</span><span class="p">[</span>
<span class="w">   </span><span class="n">Flatten</span><span class="o">@</span><span class="n">Table</span><span class="p">[</span>
<span class="w">     </span><span class="n">Eigenvalues</span><span class="p">[</span><span class="n">cfH</span><span class="w"> </span><span class="o">@@</span><span class="w"> </span><span class="n">RandomReal</span><span class="p">[{</span><span class="o">-</span><span class="n">Pi</span><span class="p">,</span><span class="w"> </span><span class="n">Pi</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">genus</span><span class="p">]],</span><span class="w"> </span>
<span class="w">    </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Round</span><span class="p">[</span><span class="n">Npts</span><span class="o">/</span><span class="n">Nruns</span><span class="p">]}],</span><span class="w"> </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nruns</span><span class="p">},</span><span class="w"> </span>
<span class="w">  </span><span class="n">Method</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;FinestGrained&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details><p>In the previous tutorials, <a class="reference internal" href="Supercells.html"><span class="std std-doc">Supercells</span></a> and <a class="reference internal" href="Flat-bands.html"><span class="std std-doc">Flat-bands</span></a>, we have considered nearest-neighbor tight-binding models through the construction of tessellation model graphs.
The HyperCells package enables the construction of extended tessellation model graphs which are comprised not only of nearest-neighbor but also <strong>next-nearest-neighbor terms</strong>. In this tutorial we will see how we can extend tessellation model graphs through the construction of next-nearest-neighbor tight-binding models on the <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-lattice. Specifically, we will consider next-nearest-neighbor terms as small perturbations as well as a variant of the Haldane model. Additionally, we will showcase how <strong>hyperbolic lattice symmetries</strong> can be analyzed in Abelian hyperbolic band theory through the construction of <strong>point-group matrices</strong>.</p>
<section id="next-nearest-neighbor-model-graph">
<h2>Next-nearest-neighbor model graph<a class="headerlink" href="#next-nearest-neighbor-model-graph" title="Link to this heading">#</a></h2>
<p>Next-nearest-neighbor terms can be added through a minor modification of the usual workflow. We start by constructing the cell graph for the primitive cell in <strong>GAP</strong>:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the HyperCells package</span>
<span class="nv">LoadPackage</span><span class="p">(</span> <span class="s">&quot;HyperCells&quot;</span> <span class="p">)</span><span class="o">;</span>
<span class="nv">tg</span> <span class="o">:=</span> <span class="nv">ProperTriangleGroup</span><span class="p">(</span> <span class="p">[</span> <span class="nv">2</span><span class="o">,</span> <span class="nv">4</span><span class="o">,</span> <span class="nv">6</span> <span class="p">]</span> <span class="p">)</span><span class="o">;</span>

<span class="c1"># Primitive cell:</span>
<span class="c1"># ---------------</span>
<span class="nv">qpc</span> <span class="o">:=</span> <span class="nv">TGQuotient</span><span class="p">(</span> <span class="nv">1</span><span class="o">,</span> <span class="p">[</span> <span class="nv">2</span><span class="o">,</span> <span class="nv">4</span><span class="o">,</span> <span class="nv">6</span> <span class="p">]</span> <span class="p">)</span><span class="o">;</span>
<span class="nv">cgpc</span> <span class="o">:=</span> <span class="nv">TGCellGraph</span><span class="p">(</span> <span class="nv">tg</span><span class="o">,</span> <span class="nv">qpc</span><span class="o">,</span> <span class="nv">3</span> : <span class="nv">simplify</span> <span class="o">:=</span> <span class="nv">5</span> <span class="p">)</span><span class="o">;</span>
<span class="nv">Export</span><span class="p">(</span> <span class="nv">cgpc</span><span class="o">,</span> <span class="s">&quot;(2,4,6)_T2.2_3.hcc&quot;</span> <span class="p">)</span><span class="o">;</span> <span class="c1"># export</span>
</pre></div>
</div>
<p>In order to add next-nearest-neighbor terms, a tessellation model graph needs to be specified beforehand. As such, let us construct the nearest-neighbor graph of the <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-tesselation of the hyperbolic plane on the primitive cell:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># Construction of underlying NN-model:</span>
<span class="c1"># -----------------------------------</span>
<span class="c1"># specify underlying model graph</span>
<span class="nv">model</span> <span class="o">:=</span> <span class="nv">TessellationModelGraph</span><span class="p">(</span><span class="nv">cgpc</span><span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>The tessellation model graph can be decorated with next-nearest-neighbor (NNN) terms through the function <code class="code-gap">AddOrientedNNNEdgesToTessellationModelGraph</code>, which introduces oriented NNN-edges with orientations in the counter-clockwise around each face based on the original tessellation model graph:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding NNN terms:</span>
<span class="c1"># -----------------</span>
<span class="nv">AddOrientedNNNEdgesToTessellationModelGraph</span><span class="p">(</span><span class="nv">model</span><span class="p">)</span><span class="o">;</span>
<span class="nv">Export</span><span class="p">(</span><span class="nv">model</span><span class="o">,</span> <span class="s">&quot;{6,4}-tess-NNN_T2.2_3.hcm&quot;</span><span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>We choose a supercell sequence by following the central concepts discussed in the tutorial <a class="reference internal" href="Supercells.html"><span class="std std-doc">Supercells</span></a> and <a class="reference internal" href="Coherent_SC_sequences.html"><span class="std std-doc">Coherent sequences</span></a>. The model specifications are inherited by subsequent supercell model graphs:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># Supercells:</span>
<span class="c1"># -----------</span>
<span class="nv">tgQS</span> <span class="o">:=</span> <span class="nv">TGQuotientSequencesStructure</span><span class="p">(</span><span class="nv">tg</span> : <span class="nv">boundByGenus</span> <span class="o">:=</span> <span class="nv">10</span><span class="p">)</span><span class="o">;;</span>
<span class="nv">sequence</span> <span class="o">:=</span> <span class="nv">LongestSequence</span><span class="p">(</span><span class="nv">tgQS</span> : <span class="nv">quotient</span> <span class="o">:=</span> <span class="nv">1</span><span class="p">)</span><span class="o">;</span>
<span class="nv">sc_lst</span> <span class="o">:=</span> <span class="nv">sequence</span><span class="p">{[</span><span class="nv">2</span><span class="o">..</span><span class="nv">Length</span><span class="p">(</span><span class="nv">sequence</span><span class="p">)]}</span><span class="o">;</span>

<span class="k">for</span> <span class="nv">sc_i_index</span> <span class="ow">in</span> <span class="nv">sc_lst</span> <span class="k">do</span>
    <span class="nv">qsc_i</span> <span class="o">:=</span> <span class="nv">TGQuotient</span><span class="p">(</span> <span class="nv">sc_i_index</span> <span class="p">)</span><span class="o">;</span>

    <span class="nv">sc_i</span> <span class="o">:=</span> <span class="nv">TGCellSymmetric</span><span class="p">(</span><span class="nv">tg</span><span class="o">,</span> <span class="nv">qsc_i</span><span class="o">,</span> <span class="nv">3</span><span class="p">)</span><span class="o">;</span>
    <span class="nv">scmodel_i</span> <span class="o">:=</span> <span class="nv">TGSuperCellModelGraph</span><span class="p">(</span><span class="nv">model</span><span class="o">,</span> <span class="nv">sc_i</span><span class="p">)</span><span class="o">;</span>

    <span class="nv">sc_i_label</span> <span class="o">:=</span> <span class="nv">StringFormatted</span><span class="p">(</span><span class="s">&quot;_T2.2_3_sc-T{}.{}.hcs&quot;</span><span class="o">,</span> <span class="nv">sc_i_index</span><span class="p">[</span><span class="nv">1</span><span class="p">]</span><span class="o">,</span> <span class="nv">sc_i_index</span><span class="p">[</span><span class="nv">2</span><span class="p">])</span><span class="o">;</span>
    <span class="nv">scmodel_i_name</span> <span class="o">:=</span> <span class="nv">JoinStringsWithSeparator</span><span class="p">([</span><span class="s">&quot;{6,4}-tess-NNN&quot;</span><span class="o">,</span> <span class="nv">sc_i_label</span><span class="p">]</span><span class="o">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">;</span>
    <span class="nv">Export</span><span class="p">(</span><span class="nv">scmodel_i</span><span class="o">,</span>  <span class="nv">scmodel_i_name</span><span class="p">)</span><span class="o">;</span> <span class="c1"># export file</span>
<span class="k">od</span><span class="o">;</span>
</pre></div>
</div>
<div class="flex ">
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_HyperCells_pc_sc_files.zip" class="btn btn-primary" class="flex-child"><i class="fa-solid fa-download"></i> Download generated files</a>
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_HyperCells.g" class="btn btn-primary" class="flex-child"><i class="fa-solid fa-download"></i> Download GAP Code</a>
</div>
<br>
</section>
<section id="nnn-tight-binding-model">
<h2><span class="math notranslate nohighlight">\(\{6,4\}\)</span>-NNN tight-binding model:<a class="headerlink" href="#nnn-tight-binding-model" title="Link to this heading">#</a></h2>
<p>Before we construct the Haldane model on the <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-lattice, let us consider a more fundamental model in order to get familiar with the procedures to assign coupling constants for next-nearest-neighbor (supercell) model graphs. As such, let us construct an elementary next-nearest-neighbor hopping model.</p>
<p>As usual, we load the HyperBloch package, set the working directory of the files we have created through the HyperCells package, define a list of available unit cells together with the corresponding genera of the compactified unit cells and import the cell, model and supercell model graph:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Preliminaries *)</span>
<span class="o">&lt;&lt;</span><span class="w"> </span><span class="nn">PatrickMLenggenhager`HyperBloch`</span>
<span class="n">SetDirectory</span><span class="p">[</span><span class="n">NotebookDirectory</span><span class="p">[]];</span>

<span class="c">(* Labels and genera *)</span>
<span class="n">cells</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;T2.2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;T5.4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;T9.3&quot;</span><span class="p">};</span><span class="w"> </span>
<span class="n">genusLst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">};</span>

<span class="c">(* Import cell and model graph of the primitive cell *)</span>
<span class="n">pcell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImportCellGraphString</span><span class="p">[</span><span class="n">Import</span><span class="p">[</span><span class="s">&quot;(2,4,6)_T2.2_3.hcc&quot;</span><span class="p">]];</span>
<span class="n">pcmodel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImportModelGraphString</span><span class="p">[</span><span class="n">Import</span><span class="p">[</span><span class="s">&quot;{6,4}-tess-NNN_T2.2_3.hcm&quot;</span><span class="p">]];</span>

<span class="c">(* Import supercell model graph *)</span>
<span class="n">scmodels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="n">ImportSupercellModelGraphString</span><span class="p">[</span><span class="w"> </span>
<span class="w">    </span><span class="n">Import</span><span class="p">[</span><span class="s">&quot;{6,4}-tess-NNN_T2.2_3_sc-&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="nv">#</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&quot;.hcs&quot;</span><span class="p">]]</span><span class="w"> </span>
<span class="w">  </span><span class="o">&amp;/@</span><span class="w"> </span><span class="n">cells</span><span class="p">[[</span><span class="mi">2</span><span class="w"> </span><span class="o">;;</span><span class="p">]]];</span>
</pre></div>
</div>
<p>Let us visualize the NN and NNN-terms of the graph representation for the next-nearest-neighbor tight-binding model on the primitive cell. They are stored as directed edges, which can be extracted from the model graph as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">EdgeList</span><span class="o">@</span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Graph&quot;</span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN-EdgeList_snippet.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN-EdgeList_snippet.png" class="figure-img img-fluid rounded" alt="{6,4} pcmodel EdgeList" width="700"/>
  </picture>
</figure>
<p>The first entry in the edge tags (the nested list above the arrow) indicate the if the edge connects NN-vertices or NNN-vertices, indicated with integers 1 and 2, respectively.  We have already discussed the edges that connect NN-vertices in <a class="reference internal" href="../GettingStarted/getSetGo_HyperBloch.html"><span class="std std-doc">Getting started with the HyperBloch package</span></a>. Now, for the NNN-edges the remaining edge tags are of the form <code class="code-Mathematica">{f, e1, e2}</code>, <code class="code-Mathematica">f</code> is the position of the face characterizing the edge in the list of faces in the model graph, and <code class="code-Mathematica">e1, e2</code> are the positions of the nearest-neighbor edges that together connect the same vertices as the next-nearest-neighbor edge in the list of edges in the model graph.</p>
<p>We can visualize the corresponding edges by using the option <code class="code-Mathematica">EdgeFilter</code> of the function <code class="code-Mathematica">ShowCellGraphFlattened</code>. This enables us to visualize edges connecting NN-vertices or NNN-vertices separately:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">Row</span><span class="p">[</span>
<span class="w"> </span><span class="n">Table</span><span class="p">[</span>
<span class="w">  </span><span class="n">Module</span><span class="p">[{</span><span class="n">filterFunction</span><span class="p">},</span>
<span class="w">   </span><span class="n">filterFunction</span><span class="p">[</span><span class="nv">edge_</span><span class="p">,</span><span class="w"> </span><span class="nv">j_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">If</span><span class="p">[</span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">edge</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">edge</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">j</span><span class="p">];</span>
<span class="w">   </span><span class="n">VisualizeModelGraph</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">CellGraph</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pcell</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="n">Elements</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">&lt;|</span>
<span class="w">        </span><span class="n">ShowCellBoundary</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">ShowEdgeIdentification</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">},</span>
<span class="w">        </span><span class="n">ShowCellGraphFlattened</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">EdgeFilter</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">filterFunction</span><span class="p">[</span><span class="nv">#</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="p">)}</span>
<span class="w">      </span><span class="o">|&gt;</span><span class="p">,</span>
<span class="w">      </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">NumberOfGenerations</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">]],</span>
<span class="w">  </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">}]]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN_pc_T2.2.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN_pc_T2.2.png" class="figure-img img-fluid rounded" alt="{6,4} NNN model  pc" width="1000"/>
  </picture>
</figure>
<p>In order to construct the Abelian Bloch Hamiltonian let us recall the general startegy to endow the model graphs with coupling constants, see <a class="reference internal" href="../GettingStarted/getSetGo_HyperBloch.html"><span class="std std-doc">Getting started with the HyperBloch package</span></a>. The list of edges, accessed through calling <code class="docutils literal notranslate"><span class="pre">EdgeList&#64;pcmodel[&quot;Graph&quot;]</span></code>, allows us to associate distinct hopping amplitudes <code class="code-Mathematica">h1</code> and <code class="code-Mathematica">h2</code> with the NN and NNN-terms, respectively. It contains 12 directed edges connecting NN-vertices followed by 24 directed edges connecting NNN-vertices, thus:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* NN-terms *)</span>
<span class="n">nnVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConstantArray</span><span class="p">[</span><span class="n">h1</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">];</span>

<span class="c">(* NNN-terms *)</span>
<span class="n">nnnVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ConstantArray</span><span class="p">[</span><span class="n">h2</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">];</span>
</pre></div>
</div>
<p>The hopping amplitudes can be assigned through an Association, with edges as keys and hopping amplitudes as values:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Construct association *)</span>
<span class="n">hoppingVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join</span><span class="p">[</span><span class="n">nnVec</span><span class="p">,</span><span class="w"> </span><span class="n">nnnVec</span><span class="p">];</span>
<span class="n">hoppingsPC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AssociationThread</span><span class="p">[</span><span class="n">EdgeList</span><span class="o">@</span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Graph&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">hoppingVec</span><span class="p">];</span>
</pre></div>
</div>
<p>The corresponding Hamiltonians are given by:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Hamiltonian for the primitive cell *)</span>
<span class="n">Hpc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AbelianBlochHamiltonian</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">hoppingsPC</span><span class="p">,</span><span class="w"> </span><span class="n">CompileFunction</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">];</span>

<span class="c">(* Hamiltonians for the supercells *)</span>
<span class="n">Hsclst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="n">AbelianBlochHamiltonian</span><span class="p">[</span><span class="n">scmodels</span><span class="p">[</span><span class="nv">#</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;</span><span class="p">,</span><span class="w"> </span><span class="n">hoppingsPC</span><span class="p">,</span><span class="w"> </span><span class="n">PCModel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span><span class="n">CompileFunction</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">]</span><span class="w"> </span>
<span class="w">  </span><span class="o">&amp;/@</span><span class="w"> </span><span class="n">cells</span><span class="p">[[</span><span class="mi">2</span><span class="w"> </span><span class="o">;;</span><span class="p">]]];</span>

<span class="c">(* All *)</span>
<span class="n">Hclst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join</span><span class="p">[</span><span class="n">Association</span><span class="p">[</span><span class="n">cells</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Hpc</span><span class="p">],</span><span class="w"> </span><span class="n">Hsclst</span><span class="p">];</span>
</pre></div>
</div>
<p>As usual, we compute the density of states of this sequence of supercells by random samples in the Brioullin zone, where we use the function <code class="code-Mathematica">ComputeEigenvalues</code>, which can be found in the dropdown menu <strong>Needed function</strong> above. We choose to treat the next-nearest-neighbor contributions as a weak coupling between sites, as such we set <code class="code-Mathematica">h1</code> to <span class="math notranslate nohighlight">\(1\)</span> and <code class="code-Mathematica">h2</code> to <span class="math notranslate nohighlight">\(0.05\)</span>:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Eigenvalues *)</span>
<span class="n">evals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ComputeEigenvalues</span><span class="p">[</span><span class="n">Hclst</span><span class="p">[</span><span class="nv">#</span><span class="p">]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="p">{</span><span class="n">h1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">0.05</span><span class="p">},</span><span class="w"> </span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">genusLst</span><span class="p">[</span><span class="nv">#</span><span class="p">]]</span><span class="o">&amp;/@</span><span class="n">cells</span><span class="p">];</span>

<span class="c">(* Color maps *)</span>
<span class="n">cLst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ColorData</span><span class="p">[</span><span class="s">&quot;SunsetColors&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ColorFunction&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">/@</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Range</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="mf">3.</span><span class="p">));</span>

<span class="c">(* Visualize *)</span>
<span class="n">SmoothHistogram</span><span class="p">[</span><span class="n">evals</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PDF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">Frame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">FrameLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Energy E&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Density of states&quot;</span><span class="p">}</span><span class="w"> </span><span class="n">FrameStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Black</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">ImagePadding</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">}},</span><span class="w"> </span><span class="n">LabelStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">  </span><span class="n">PlotLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;k sampling: 10^4&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">PlotRange</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">All</span><span class="p">,</span><span class="w"> </span><span class="n">PlotStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">cLst</span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/dos_tess-NNN-64_scm.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/dos_tess-NNN-64_scm.png" class="figure-img img-fluid rounded" alt="{6,4} NNN DOS" width="500"/>
  </picture>
</figure>
</section>
<section id="id1">
<h2>Haldane model<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>The next-nearest-neighbor tight-binding model can easily be extended to a variant of the Haldane model. Analogous to original Haldane model, our variant should thread the <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-lattice by <strong>local magnetic fluxes</strong> with net zero flux per hyperbolic hexagon. Let us highlight the central hyperbolic hexagon, which should be threaded with a net zero flux. The hexagon is associated with a face in the model graph and can be extracted through the function <code class="code-Mathematica">GetCellGraphFace</code>:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">face</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetCellGraphFace</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Faces&quot;</span><span class="p">][[</span><span class="mi">1</span><span class="p">]]];</span>
</pre></div>
</div>
<p>The returned object is a <code class="code-Mathematica">Polygon</code> that can be visualized in the Poincaré disk as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">Show</span><span class="p">[</span>
<span class="w"> </span><span class="n">VisualizeModelGraph</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span>
<span class="w">  </span><span class="n">CellGraph</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pcell</span><span class="p">,</span>
<span class="w">  </span><span class="n">Elements</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="o">&lt;|</span>
<span class="w">    	</span><span class="n">ShowCellGraphFlattened</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{},</span>
<span class="w">    	</span><span class="n">ShowCellBoundary</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="n">ShowEdgeIdentification</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">}</span>
<span class="w">    </span><span class="o">|&gt;</span><span class="p">,</span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span>
<span class="w">  </span><span class="n">NumberOfGenerations</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">3</span><span class="p">],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Opacity</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">FaceForm</span><span class="p">[{</span><span class="n">Darker</span><span class="o">@</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="n">Opacity</span><span class="p">[</span><span class="mf">0.5</span><span class="p">]}],</span><span class="w"> </span><span class="n">face</span><span class="p">}]</span>
<span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN_pc_T2.2-hypHex.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-tess-NNN_pc_T2.2-hypHex.png" class="figure-img img-fluid rounded" alt="{6,4} NNN model  pc" width="400"/>
  </picture>
</figure>
<p>The directed edges for the NNN-terms are oriented such that a <strong>Peierls substitution</strong> can be performed by multiplying the previously defined constant vector <code class="docutils literal notranslate"><span class="pre">nnnVec</span></code> by a phase <strong><span class="math notranslate nohighlight">\(e^{i\phi}\)</span></strong> . The resulting <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-lattice is threaded by <strong>local magnetic fluxes</strong> with net zero flux per hyperbolic hexagon:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* NNN-terms *)</span>
<span class="n">phase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Exp</span><span class="p">[</span><span class="n">I</span><span class="w"> </span><span class="n">Phi</span><span class="p">];</span>
<span class="n">nnnVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phase</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nnnVec</span><span class="p">;</span>

<span class="c">(* Construct association *)</span>
<span class="n">hoppingVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join</span><span class="p">[</span><span class="n">nnVec</span><span class="p">,</span><span class="w"> </span><span class="n">nnnVec</span><span class="p">];</span>
<span class="n">hoppingsPC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AssociationThread</span><span class="p">[</span><span class="n">EdgeList</span><span class="o">@</span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Graph&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">hoppingVec</span><span class="p">];</span>
</pre></div>
</div>
<p>Since the hyperbolic hexagons have an even number of sides the lattice can be considered as bipartite such that a sublattice mass can be realized by a <strong>staggered on-site potential</strong> <strong><span class="math notranslate nohighlight">\(\pm m\)</span></strong>. It is instructive to take a look at the list of vertices in the model graph:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">VertexList</span><span class="o">@</span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Graph&quot;</span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HatanoNelson/vertices_{6,4}-tess-NN_pc_T2.2.png">
    <img src="../../media/figs/Tutorials/HatanoNelson/vertices_{6,4}-tess-NN_pc_T2.2.png" class="figure-img img-fluid rounded" alt="Vertices tessellation model {6,4}-lattice" width="500"/>
  </picture>
</figure>
<p>Comparing the list of vertices with the model representation we have previously visualized, we can assign the staggered on-site potential as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">mVec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="p">};</span>
<span class="n">onsitePC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AssociationThread</span><span class="p">[</span><span class="n">VertexList</span><span class="o">@</span><span class="n">pcmodel</span><span class="p">[</span><span class="s">&quot;Graph&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">mVec</span><span class="p">];</span>
</pre></div>
</div>
<p>The Abelian Bloch Hamiltonians are given by:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Hamiltonian for the primitive cell *)</span>
<span class="n">Hpc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AbelianBlochHamiltonian</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">onsitePC</span><span class="p">,</span><span class="w"> </span><span class="n">hoppingsPC</span><span class="p">,</span><span class="w"> </span><span class="n">CompileFunction</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">];</span>

<span class="c">(* Hamiltonians for the supercells *)</span>
<span class="n">Hsclst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="n">AbelianBlochHamiltonian</span><span class="p">[</span><span class="n">scmodels</span><span class="p">[</span><span class="nv">#</span><span class="p">],</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">onsitePC</span><span class="p">,</span><span class="w"> </span><span class="n">hoppingsPC</span><span class="p">,</span><span class="w"> </span><span class="n">PCModel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">pcmodel</span><span class="p">,</span><span class="w"> </span><span class="n">CompileFunction</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">]</span><span class="w"> </span>
<span class="w">  </span><span class="o">&amp;/@</span><span class="w"> </span><span class="n">cells</span><span class="p">[[</span><span class="mi">2</span><span class="w"> </span><span class="o">;;</span><span class="p">]]];</span>

<span class="c">(* All *)</span>
<span class="n">Hclst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Join</span><span class="p">[</span><span class="n">Association</span><span class="p">[</span><span class="n">cells</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Hpc</span><span class="p">],</span><span class="w"> </span><span class="n">Hsclst</span><span class="p">];</span>
</pre></div>
</div>
<p>The density of states can be computed as usual:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="c">(* Eigenvalues *)</span>
<span class="n">evals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="n">ComputeEigenvalues</span><span class="p">[</span><span class="n">Hclst</span><span class="p">[</span><span class="nv">#</span><span class="p">]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="p">{</span><span class="n">h1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Phi</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">genusLst</span><span class="p">[</span><span class="nv">#</span><span class="p">]]</span>
<span class="w">  </span><span class="o">&amp;/@</span><span class="n">cells</span><span class="p">];</span>

<span class="c">(* Visualize *)</span>
<span class="n">SmoothHistogram</span><span class="p">[</span><span class="n">evals</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PDF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">Frame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">FrameLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Energy E&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Density of states&quot;</span><span class="p">}</span><span class="w"> </span><span class="n">FrameStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Black</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">ImagePadding</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">}},</span><span class="w"> </span><span class="n">LabelStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">  </span><span class="n">PlotLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;k sampling: 10^4&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">PlotRange</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">All</span><span class="p">,</span><span class="w"> </span><span class="n">PlotStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">cLst</span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/dos_Haldane-64_scm.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/dos_Haldane-64_scm.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS" width="500"/>
  </picture>
</figure>
<p>The application of the supercell method reveals spurious feature in the density of states of the primitive cell when using the Abelian Hyperbolic band theory. Some of the Abelian states lie outside the energy range with finite density in the thermodynamic limit and thus the band touching at zero energy can be considered a finite size effect.</p>
<div style="text-align: right;">
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_HyperBloch.nb" class="btn btn-primary"><i class="fa-solid fa-download"></i> Download Mathematica Notebook</a>
</div>
</section>
<section id="point-group-matrices">
<h2>Point-group matrices<a class="headerlink" href="#point-group-matrices" title="Link to this heading">#</a></h2>
<p>Symmetry elements of triangle groups might act non-trivially on hyperbolic momenta. As such, the degrees of freedom of observables and <strong>topological invariants</strong>, like the <strong>first Chern numbers</strong> in momentum space, might be constrained by the hyperbolic lattice symmetries of underlying models. We can determine how hyperbolic momenta transform as hyperbolic lattice symmetry transformations act on Abelian states. This can be extracted by constructing <strong>point-group matrices</strong>.</p>
<p>Point-group matrices can be constructed by specifying the hyperbolic lattice symmetries in terms of generators of the triangle group <span class="math notranslate nohighlight">\(\Delta(2,q,p)\)</span> or the proper triangle group <span class="math notranslate nohighlight">\(\Delta^{+}(2,q,p)\)</span>. Let us visualize the action of the symmetry generators on the fundamental Schwarz triangle <code class="code-gap">s<sub>f</sub></code> of the <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-tesselation of the hyperbolic plane:</p>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/Sym64.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/Sym64.png" class="figure-img img-fluid rounded" alt="symmeries of the {6,4}-tesselation" width="400"/>
  </picture>
</figure>
<p>For example, the generator <code class="code-gap">z</code> of the proper triangle group <span class="math notranslate nohighlight">\(\Delta^{+}\)</span> is a composition of two reflection generators <code class="code-gap">c*a</code> of <span class="math notranslate nohighlight">\(\Delta\)</span>. The fundamental Schwarz triangle is  rotated by <span class="math notranslate nohighlight">\(2 \pi/6\)</span> in counter clockwise direction to an adjacent copy under the action of the operator <code class="code-gap">z</code>. We can construct the operator as follows:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># proper triangle group </span>
<span class="nv">D</span> <span class="o">:=</span> <span class="nv">FpGroup</span><span class="p">(</span><span class="nv">tg</span><span class="p">)</span><span class="o">;</span>

<span class="c1"># symmetry</span>
<span class="nv">z</span> <span class="o">:=</span> <span class="nv">D</span><span class="o">.</span><span class="nv">3</span><span class="o">;</span>
<span class="nv">symmetry</span> <span class="o">:=</span> <span class="nv">z</span><span class="o">;</span>
<span class="nv">symName</span> <span class="o">:=</span> <span class="s">&quot;z&quot;</span><span class="o">;</span>
</pre></div>
</div>
<p>Point-group matrices define representations of point groups <span class="math notranslate nohighlight">\(G^{(m)}\cong\Delta/\Gamma^{(m)}\)</span>. This implies that it is sufficient to construct the point-group matrices for a minimal set of operators, such that matrix multiplications can be performed in order to construct the point-group matrices of other elements in the point group. As such, we first need to construct the point-group matrices for the rotation generators of the triangle group group for any given unit cell identified through a corresponding triangle group quotient <span class="math notranslate nohighlight">\(\Delta/\Gamma^{(m)}\)</span>.</p>
<p>They can be computed through the function <code class="code-gap">PGMatricesOfGenerators</code>, which takes the triangle group, proper triangle group and a triangle group quotient as arguments. As such, we first need to construct the triangle group:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># TriangleGroup obj.</span>
<span class="nv">fulltg</span> <span class="o">:=</span> <span class="nv">TriangleGroup</span><span class="p">(</span> <span class="p">[</span> <span class="nv">2</span><span class="o">,</span> <span class="nv">4</span><span class="o">,</span> <span class="nv">6</span> <span class="p">]</span> <span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>Next, let us construct the point-group matrices of the triangle generators for the primitive cell:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the PGMatricesOfGenerators</span>
<span class="nv">pgMatGs</span> <span class="o">:=</span> <span class="nv">PGMatricesOfGenerators</span><span class="p">(</span><span class="nv">fulltg</span><span class="o">,</span> <span class="nv">tg</span><span class="o">,</span> <span class="nv">qpc</span><span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>The point-group matrix for the symmetry <code class="code-gap">z</code> can now be evaluated through the function <code class="code-gap">EvaluatePGMatrix</code>:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="nv">gap</span><span class="o">&gt;</span>  <span class="nv">EvaluatePGMatrix</span><span class="p">(</span><span class="nv">z</span><span class="o">,</span> <span class="nv">pgMatGs</span><span class="p">)</span><span class="o">;</span>
<span class="p">[</span> <span class="p">[</span>  <span class="nv">0</span><span class="o">,</span> <span class="o">-</span><span class="nv">1</span><span class="o">,</span>  <span class="nv">0</span><span class="o">,</span>  <span class="nv">0</span> <span class="p">]</span><span class="o">,</span> 
  <span class="p">[</span>  <span class="nv">0</span><span class="o">,</span>  <span class="nv">0</span><span class="o">,</span> <span class="o">-</span><span class="nv">1</span><span class="o">,</span>  <span class="nv">0</span> <span class="p">]</span><span class="o">,</span> 
  <span class="p">[</span>  <span class="nv">0</span><span class="o">,</span>  <span class="nv">1</span><span class="o">,</span>  <span class="nv">0</span><span class="o">,</span> <span class="o">-</span><span class="nv">1</span> <span class="p">]</span><span class="o">,</span> 
  <span class="p">[</span>  <span class="nv">1</span><span class="o">,</span>  <span class="nv">0</span><span class="o">,</span>  <span class="nv">0</span><span class="o">,</span>  <span class="nv">0</span> <span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
<p>Let us construct a particular point-group matrix for a symmetry analysis <span class="math notranslate nohighlight">\(\{6,4\}\)</span>-Haldane model. In principle, there are two sets of symmetry operations that leave the model invariant, which are dictated by the configuration of the coupling constants, i.e, if the staggered on-site potential is non-zero or not. However, we will focus on a particular symmetry transformation that is common among them.</p>
<p>The model is left invariant under a reflection <code class="code-gap">c</code> composed with time reversal <code class="code-gap">T</code> (note that an anti-unitary symmetry transformation, like time reversal, leads to an overall sign change of the point-group matrix, which we will consider later).</p>
<p>We have already constructed the corresponding point-group matrix through the function <code class="code-gap">PGMatricesOfGenerators</code>. However, let us choose to construct it once more as a sparse representation by passing the option <code class="code-gap">sparse</code>:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># get the PGMatricesOfGenerators</span>
<span class="nv">pgMatGs</span> <span class="o">:=</span> <span class="nv">PGMatricesOfGenerators</span><span class="p">(</span><span class="nv">fulltg</span><span class="o">,</span> <span class="nv">tg</span><span class="o">,</span> <span class="nv">qpc</span> : <span class="nv">sparse</span> <span class="o">:=</span> <span class="no">true</span><span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>A set of point-group matrices can only be exported by first calling the function <code class="code-gap">PGMatrices</code>. We choose to export the point-group matrices for <code class="code-gap">c</code> and <code class="code-gap">z</code>. However, we only need to specify the <code class="code-gap">z</code>, since the point-group matrices of the triangle group generators will be inherited:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct and export the PGMatrices</span>
<span class="nv">pgMat_T2_2</span> <span class="o">:=</span> <span class="nv">PGMatrices</span><span class="p">(</span><span class="nv">symmetry</span><span class="o">,</span> <span class="nv">pgMatGs</span> : <span class="nv">symNames</span> <span class="o">:=</span> <span class="nv">symName</span><span class="p">)</span><span class="o">;</span>
<span class="nv">Export</span><span class="p">(</span><span class="nv">pgMat_T2_2</span><span class="o">,</span> <span class="s">&quot;(2,4,6)-T2.2-pgMat_z_sparse.hcpgm&quot;</span><span class="p">)</span><span class="o">;</span>
</pre></div>
</div>
<p>We can repeat the procedure for the chosen supercell sequence:</p>
<div class="highlight-gap notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quotients T5.4, T9.3 (supercells):</span>
<span class="c1"># ---------------------------------</span>
<span class="k">for</span> <span class="nv">sc_i_index</span> <span class="ow">in</span> <span class="nv">sc_lst</span> <span class="k">do</span>
  <span class="nv">qsc_i</span> <span class="o">:=</span> <span class="nv">TGQuotient</span><span class="p">(</span> <span class="nv">sc_i_index</span> <span class="p">)</span><span class="o">;</span>

  <span class="c1"># get the PGMatricesOfGenerators</span>
  <span class="nv">pgMatGs</span> <span class="o">:=</span> <span class="nv">PGMatricesOfGenerators</span><span class="p">(</span><span class="nv">fulltg</span><span class="o">,</span> <span class="nv">tg</span><span class="o">,</span> <span class="nv">qsc_i</span> : <span class="nv">sparse</span> <span class="o">:=</span> <span class="no">true</span><span class="p">)</span><span class="o">;</span>

  <span class="c1"># construct and export the PGMatrices</span>
  <span class="nv">pgMat_sc_i</span> <span class="o">:=</span> <span class="nv">PGMatrices</span><span class="p">(</span><span class="nv">symmetry</span><span class="o">,</span> <span class="nv">pgMatGs</span> : <span class="nv">symNames</span> <span class="o">:=</span> <span class="nv">symName</span><span class="p">)</span><span class="o">;</span>

  <span class="nv">sc_i_label</span> <span class="o">:=</span> <span class="nv">StringFormatted</span><span class="p">(</span><span class="s">&quot;(2,4,6)-T{}.{}-pgMat_z_sparse.hcpgm&quot;</span><span class="o">,</span> <span class="nv">sc_i_index</span><span class="p">[</span><span class="nv">1</span><span class="p">]</span><span class="o">,</span> <span class="nv">sc_i_index</span><span class="p">[</span><span class="nv">2</span><span class="p">])</span><span class="o">;</span>
  <span class="nv">Export</span><span class="p">(</span><span class="nv">pgMat_sc_i</span><span class="o">,</span> <span class="nv">sc_i_label</span><span class="p">)</span><span class="o">;</span>
<span class="k">od</span><span class="o">;</span>
</pre></div>
</div>
<div class="flex ">
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_PGMatrices_files.zip" class="btn btn-primary" class="flex-child"><i class="fa-solid fa-download"></i> Download generated files</a>
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_PGMatrices_HyperCells.g" class="btn btn-primary" class="flex-child"><i class="fa-solid fa-download"></i> Download GAP Code</a>
</div>
<section id="application">
<h3>Application<a class="headerlink" href="#application" title="Link to this heading">#</a></h3>
<p>Point-group matrices can be used to conduct symmetry analysis on any given (supercell) model graph. Let us perform a symmetry transformation for the variant of the Haldane model we have considered above, in order to see how the corresponding spectra are effected.</p>
<p>The point-group matrices can be imported analogously to (supercell) model graphs. As such, the <code class="code-Mathematica">Import</code> function is used to read the file, while the <code class="code-Mathematica">ImportPGMatricesString</code> function is used to parse the string and construct the point-group matrices:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">pgMatSc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ImportPGMatricesString</span><span class="p">[</span><span class="n">Import</span><span class="p">[</span><span class="s">&quot;(2,4,6)-&quot;</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="nv">#</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="s">&quot;-pgMat_z_sparse.hcpgm&quot;</span><span class="p">]]</span><span class="o">&amp;/@</span><span class="n">cells</span><span class="p">];</span>
</pre></div>
</div>
<p>The spectrum of the Haldane model should be left invariant under the hyperbolic lattice symmetry transformation <code class="code-Mathematica">c</code>. This can easily be verified by an explicit transformation of the hyperbolic momenta through the following modification of the function defined in the dropdown menu <strong>Needed function</strong> above:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">ComputeEigenvalues</span><span class="p">[</span><span class="nv">cfH_</span><span class="p">,</span><span class="w"> </span><span class="nv">pgMat_</span><span class="p">,</span><span class="w"> </span><span class="nv">Npts_</span><span class="p">,</span><span class="w"> </span><span class="nv">Nruns_</span><span class="p">,</span><span class="w"> </span><span class="nv">genus_</span><span class="p">]</span><span class="w"> </span><span class="o">:=</span>
<span class="w"> </span><span class="n">Flatten</span><span class="o">@</span><span class="n">ParallelTable</span><span class="p">[</span>
<span class="w">   </span><span class="n">Flatten</span><span class="o">@</span><span class="n">Table</span><span class="p">[</span>
<span class="w">     </span><span class="n">Eigenvalues</span><span class="p">[</span><span class="n">cfH</span><span class="w"> </span><span class="o">@@</span><span class="w"> </span><span class="p">(</span><span class="n">Dot</span><span class="p">[</span><span class="o">-</span><span class="n">pgMat</span><span class="p">,</span><span class="n">RandomReal</span><span class="p">[{</span><span class="o">-</span><span class="n">Pi</span><span class="p">,</span><span class="w"> </span><span class="n">Pi</span><span class="p">},</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="n">genus</span><span class="p">]])],</span><span class="w"> </span>
<span class="w">     </span><span class="p">{</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Round</span><span class="p">[</span><span class="n">Npts</span><span class="o">/</span><span class="n">Nruns</span><span class="p">]}],</span>
<span class="w">   </span><span class="p">{</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Nruns</span><span class="p">},</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;FinestGrained&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>where we have multiplied the point-group matrix <code class="code-Mathematica">pgMat</code> by <code class="code-Mathematica">-1</code> in order to account for the anti-unitarity of the transformation. The point-group matrices can be extracted by using the corresponding symmetry names as keys. We compute the Eigenvalues with a set of <span class="math notranslate nohighlight">\(10^4\)</span> random samples in momentum space, partitioned into <span class="math notranslate nohighlight">\(32\)</span> subsets as before and pass the point-group matrix for the symmetry transformation <code class="code-Mathematica">cT</code> to the function:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">evals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Association</span><span class="p">[</span><span class="nv">#</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="n">ComputeEigenvalues</span><span class="p">[</span><span class="n">Hclst</span><span class="p">[</span><span class="nv">#</span><span class="p">]</span><span class="w"> </span><span class="o">/.</span><span class="w"> </span><span class="p">{</span><span class="n">h1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">h2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Phi</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="p">},</span><span class="w"> </span>
<span class="w">    </span><span class="o">-</span><span class="n">pgMatSc</span><span class="p">[</span><span class="nv">#</span><span class="p">][</span><span class="s">&quot;c&quot;</span><span class="p">],</span><span class="w"> </span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span><span class="w"> </span><span class="n">genusLst</span><span class="p">[</span><span class="nv">#</span><span class="p">]]</span><span class="w"> </span>
<span class="w">  </span><span class="o">&amp;</span><span class="w"> </span><span class="o">/@</span><span class="w"> </span><span class="n">cells</span><span class="p">];</span>
</pre></div>
</div>
<p>The resulting density of states is unchanged (aside from negligible changes due to random sampling in combination with a relatively small sample size):</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">SmoothHistogram</span><span class="p">[</span><span class="n">evals</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;PDF&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">Frame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">,</span><span class="w"> </span><span class="n">FrameLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;Energy E&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Density of states&quot;</span><span class="p">}</span><span class="w"> </span><span class="n">FrameStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Black</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">ImagePadding</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="n">Automatic</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">}},</span><span class="w"> </span><span class="n">LabelStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
<span class="w">  </span><span class="n">PlotLabel</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Mc k sampling: 10^4&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">PlotRange</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">All</span><span class="p">,</span><span class="w"> </span><span class="n">PlotStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">cLst</span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/dos_Haldane-64_scm_PGMatrices.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/dos_Haldane-64_scm_PGMatrices.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS, PGMatrix c" width="500"/>
  </picture>
</figure>
<div style="text-align: right;">
  <a href="../../misc/code_snippets/Tutorials/HaldaneModel/tutorial_HaldaneModel_HyperBloch.nb" class="btn btn-primary"><i class="fa-solid fa-download"></i> Download Mathematica Notebook</a>
</div>
</section>
<section id="visualize-reflections-and-rotations-bonus">
<h3>Visualize reflections and rotations (bonus):<a class="headerlink" href="#visualize-reflections-and-rotations-bonus" title="Link to this heading">#</a></h3>
<p>The visualization toolbox of the HyperBloch package enables us to visualize how symmetries act on the graph representation of models. Let us reproduce the illustration of how generators of the triangle group and proper triangle group act on the fundamental Schwarz triangle.</p>
<section id="fundamental-schwarz-triangle">
<h4>Fundamental Schwarz triangle<a class="headerlink" href="#fundamental-schwarz-triangle" title="Link to this heading">#</a></h4>
<p>We can highlighted individual Schwarz triangles in the Poincaré disk through the function <code class="code-Mathematica">GetSchwarzTriangle</code>. For example, let us extract the <code class="code-Mathematica">Polygon</code> representing the fundamental Schwarz triangle associated with the identity element in the proper triangle group <span class="math notranslate nohighlight">\(\Delta^+(2,4,6)\)</span>:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">sf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetSchwarzTriangle</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">];</span>
</pre></div>
</div>
<p>The fundamental Schwarz triangle can be visualized in the Poincaré disk, we may choose the function <code class="code-Mathematica">ShowTriangles</code> to achieve this:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">g1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Show</span><span class="p">[</span>
<span class="w">  </span><span class="n">ShowTriangles</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">NumberOfGenerations</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">2</span><span class="p">],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Gray</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">],</span><span class="w"> </span><span class="n">sf</span><span class="p">}],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;s_f&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">,</span><span class="w"> </span><span class="n">White</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mf">0.09</span><span class="p">}]}],</span>
<span class="w">  </span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span>
<span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS, PGMatrix c" width="400"/>
  </picture>
</figure>
</section>
<section id="reflections">
<h4>Reflections<a class="headerlink" href="#reflections" title="Link to this heading">#</a></h4>
<p>The reflections associated with the triangle group generators acting on the fundamental Schwarz triangle <span class="math notranslate nohighlight">\(s_{f}\)</span> can be indicated in the Poincaré disk through the function <code class="code-Mathematica">GetEdge</code> which enables us to extract a <code class="code-Mathematica">Line</code> representing the edge (or succession of edges) specified by vertices. We choose pairs of vertices such that each line extends a side of <span class="math notranslate nohighlight">\(s_{f}\)</span> shown as hyperbolic geodesics. Each vertex is of the form  <span class="math notranslate nohighlight">\(\{w_{i},\)</span> “<span class="math notranslate nohighlight">\(g_{i}\)</span>” <span class="math notranslate nohighlight">\(\}\)</span> , where <span class="math notranslate nohighlight">\(w_{i}\)</span> specifies a <strong>Wyckoff position</strong> and “<span class="math notranslate nohighlight">\(g_{i}\)</span>” a symmetry operation:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">aLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetEdge</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z^3*x&quot;</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;z^3*x*z^3&quot;</span><span class="p">}}];</span>
<span class="n">bLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetEdge</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x*y^2&quot;</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;x*y^2*x&quot;</span><span class="p">}}];</span>
<span class="n">cLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetEdge</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y^2&quot;</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y^2*z^3&quot;</span><span class="p">}}];</span>
</pre></div>
</div>
<p>The lines can be visualized in Poincaré disk together with the fundamental Schwarz triangle as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">Show</span><span class="p">[</span><span class="n">g1</span><span class="p">,</span>
<span class="w">  </span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">aLine</span><span class="p">}],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">bLine</span><span class="p">}],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">cLine</span><span class="p">}],</span>
<span class="w">  </span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.17</span><span class="p">,</span><span class="w"> </span><span class="mf">0.17</span><span class="p">}]}],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;b&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.47</span><span class="p">,</span><span class="w"> </span><span class="mf">0.14</span><span class="p">}]}],</span>
<span class="w">  </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;c&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.27</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.05</span><span class="p">}]}],</span>
<span class="w">  </span>
<span class="w">  </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span>
<span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_reflections.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_reflections.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS, PGMatrix c" width="400"/>
  </picture>
</figure>
</section>
<section id="rotations">
<h4>Rotations<a class="headerlink" href="#rotations" title="Link to this heading">#</a></h4>
<p>Similarly, the rotations associated with the proper triangle group generators acting on the fundamental Schwarz triangle <span class="math notranslate nohighlight">\(s_{f}\)</span> can be indicated in the Poincaré disk through the functions <code class="code-Mathematica">GetSchwarzTriangle</code> and <code class="code-Mathematica">GetVertex</code>, the latter enables us to extract a <code class="code-Mathematica">Point</code> representing a vertex in the Poincaré disk.
Under the right action of the proper triangle group generators the fundamental Schwarz triangle is transported as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">xsf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetSchwarzTriangle</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="s">&quot;x&quot;</span><span class="p">];</span>
<span class="n">ysf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetSchwarzTriangle</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">];</span>
<span class="n">zsf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetSchwarzTriangle</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="s">&quot;z&quot;</span><span class="p">];</span>
</pre></div>
</div>
<p>The <code class="code-Mathematica">Point</code>s representing the vertices of the fundamental Schwarz triangle, which are of the form <span class="math notranslate nohighlight">\(\{w_{i},\)</span> “<span class="math notranslate nohighlight">\(g_{i}\)</span>” <span class="math notranslate nohighlight">\(\}\)</span>, can be extracted as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetVertex</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">}];</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetVertex</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">}];</span>
<span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetVertex</span><span class="p">[{</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="p">}];</span>
</pre></div>
</div>
<p>In addition, let us indicate the rotations with segments of circles:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">arcArrow</span><span class="p">[</span><span class="nv">a_</span><span class="p">,</span><span class="w"> </span><span class="nv">r_</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nv">start_</span><span class="p">,</span><span class="w"> </span><span class="nv">end_</span><span class="p">}]</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">Module</span><span class="p">[{</span><span class="n">arrForm</span><span class="p">},</span>
<span class="w">  </span><span class="n">arrForm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Graphics</span><span class="p">[</span><span class="n">Line</span><span class="p">[{{{</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="mi">-1</span><span class="p">,</span><span class="w"> </span><span class="mi">-1</span><span class="o">/</span><span class="mi">2</span><span class="p">}}}]];</span>
<span class="w">  </span><span class="p">{</span><span class="n">Arrowheads</span><span class="p">[{{</span><span class="mf">.005</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">arrForm</span><span class="p">}}],</span><span class="w"> </span><span class="n">Arrow</span><span class="p">[</span><span class="n">Circle</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">start</span><span class="p">,</span><span class="w"> </span><span class="n">end</span><span class="p">}]]}</span>
<span class="p">]</span>

<span class="n">xar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arcArrow</span><span class="p">[</span><span class="n">x</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span><span class="w"> </span><span class="mf">0.07</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mi">3</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">}];</span>
<span class="n">yar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arcArrow</span><span class="p">[</span><span class="n">y</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span><span class="w"> </span><span class="mf">0.09</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="n">Pi</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">}];</span>
<span class="n">zar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arcArrow</span><span class="p">[</span><span class="n">z</span><span class="p">[[</span><span class="mi">1</span><span class="p">]],</span><span class="w"> </span><span class="mf">0.11</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="mf">0.2</span><span class="p">,</span><span class="w"> </span><span class="n">Pi</span><span class="o">/</span><span class="mi">3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.2</span><span class="p">}];</span>
</pre></div>
</div>
<p>The vertices and Schwarz triangles can be visualized in Poincaré disk together with the fundamental Schwarz triangle as follows:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">Show</span><span class="p">[</span><span class="n">g1</span><span class="p">,</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">x</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">z</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mf">1.5</span><span class="p">],</span><span class="w"> </span><span class="n">xar</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mf">1.5</span><span class="p">],</span><span class="w"> </span><span class="n">yar</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mf">1.5</span><span class="p">],</span><span class="w"> </span><span class="n">zar</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Opacity</span><span class="p">[</span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">xsf</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Opacity</span><span class="p">[</span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">ysf</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">Opacity</span><span class="p">[</span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">zsf</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.39</span><span class="p">,</span><span class="w"> </span><span class="mf">0.33</span><span class="p">}]}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.48</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.16</span><span class="p">}]}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.08</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">}]}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span>
<span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_rotations1.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_rotations1.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS, PGMatrix c" width="400"/>
  </picture>
</figure>
<p>Alternatively, we may as well use the function <code class="code-Mathematica">ShowCellSchwarzTriangles</code> together with the option <code class="code-Mathematica">TriangleRange</code> and <code class="code-Mathematica">ShowTriangleLabels</code> if the Schwarz triangles are within the unit cell specified by the (supercell) model graph, in order to indicate the Schwarz triangles, instead of the function <code class="code-Mathematica">GetSchwarzTriangle</code>,:</p>
<div class="highlight-Mathematica notranslate"><div class="highlight"><pre><span></span><span class="n">Show</span><span class="p">[</span><span class="n">g1</span><span class="p">,</span>
<span class="w"> </span><span class="n">ShowCellSchwarzTriangles</span><span class="p">[</span><span class="n">pcmodel</span><span class="p">,</span>
<span class="w">  </span><span class="n">ShowTriangleLabels</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">True</span><span class="p">,</span>
<span class="w">  </span><span class="n">TriangleLabelStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Directive</span><span class="p">[</span><span class="n">Black</span><span class="p">,</span><span class="w"> </span><span class="n">Italic</span><span class="p">,</span><span class="w"> </span><span class="mi">18</span><span class="p">],</span>
<span class="w">  </span><span class="n">TriangleStyle</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Lighter</span><span class="p">[</span><span class="n">Gray</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">],</span>
<span class="w">  </span><span class="n">TriangleRange</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">x</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">y</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">],</span><span class="w"> </span><span class="n">PointSize</span><span class="p">[</span><span class="mf">0.02</span><span class="p">],</span><span class="w"> </span><span class="n">z</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">xar</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">yar</span><span class="p">}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">],</span><span class="w"> </span><span class="n">AbsoluteThickness</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">zar</span><span class="p">}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Green</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.48</span><span class="p">,</span><span class="w"> </span><span class="mf">0.20</span><span class="p">}]}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Red</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;y&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.38</span><span class="p">,</span><span class="w"> </span><span class="mf">-0.06</span><span class="p">}]}],</span>
<span class="w"> </span><span class="n">Graphics</span><span class="p">[{</span><span class="n">Darker</span><span class="p">[</span><span class="n">Blue</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">],</span><span class="w"> </span><span class="n">Text</span><span class="p">[</span><span class="n">Style</span><span class="p">[</span><span class="s">&quot;z&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="n">Thick</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="mf">0.12</span><span class="p">,</span><span class="w"> </span><span class="mf">0.12</span><span class="p">}]}],</span>
<span class="w"> </span>
<span class="w"> </span><span class="n">ImageSize</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">500</span>
<span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
<figure class="text-center">
  <picture> 
    <source type="image/svg+xml" srcset="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_rotations2.png">
    <img src="../../media/figs/Tutorials/HaldaneModel/{6,4}-lattice_fundSw_rotations2.png" class="figure-img img-fluid rounded" alt="{6,4} Haldane DOS, PGMatrix c" width="400"/>
  </picture>
</figure>
<p>The triangles are labeled by the corresponding right action of the elements in
<span class="math notranslate nohighlight">\(T_{\Delta}(\Gamma)\)</span> acting on the fundamental Schwarz triangle <span class="math notranslate nohighlight">\(s_f\)</span>, written as words in terms of the generators <span class="math notranslate nohighlight">\(x, y, z\)</span> of the proper triangle group <span class="math notranslate nohighlight">\(\Delta^{+}\)</span>. These labels are equivalent to the colored labels we have added manually.</p>
</section>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Flat-bands.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Flat-bands</p>
      </div>
    </a>
    <a class="right-next"
       href="HatanoNelson_model.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Hatano-Nelson model</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-nearest-neighbor-model-graph">Next-nearest-neighbor model graph</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nnn-tight-binding-model"><span class="math notranslate nohighlight">\(\{6,4\}\)</span>-NNN tight-binding model:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Haldane model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#point-group-matrices">Point-group matrices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#application">Application</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-reflections-and-rotations-bonus">Visualize reflections and rotations (bonus):</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#fundamental-schwarz-triangle">Fundamental Schwarz triangle</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#reflections">Reflections</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rotations">Rotations</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023-2025, Patrick M. Lenggenhager, Joseph Maciejko and Tomáš Bzdušek. Website development and tutorials by Marcelo Looser.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>